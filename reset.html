<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Redirigiendo a Laia...</title>
    <script>
      window.onload = () => {
        // Extraer del fragmento #access_token=...&type=recovery
        const hashParams = new URLSearchParams(window.location.hash.slice(1));
        const accessToken = hashParams.get('access_token');
        const type = hashParams.get('type');

        if (accessToken && type) {
          // Redirigir al deep link
          const deepLink = `laia://reset-password?access_token=${accessToken}&type=${type}`;
          window.location.href = deepLink;
        } else {
          document.getElementById("status").innerText = "❌ Token o tipo no encontrado en el hash.";
        }
      };
    </script>
  </head>
  <body style="font-family: sans-serif; text-align: center; margin-top: 50px;">
    <h1>Redirigiendo a la app Laia...</h1>
    <p id="status">⏳ Procesando...</p>
    <p>Si no eres redirigido, <a href="#" id="manualLink">haz clic aquí</a>.</p>

    <script>
      setTimeout(() => {
        const hashParams = new URLSearchParams(window.location.hash.slice(1));
        const accessToken = hashParams.get('access_token');
        const type = hashParams.get('type');

        if (accessToken && type) {
          const deepLink = `laia://reset-password?access_token=${accessToken}&type=${type}`;
          document.getElementById("manualLink").href = deepLink;
          document.getElementById("manualLink").innerText = "haz clic aquí para abrir Laia";
        }
      }, 100);
    </script>
  </body>
</html>
